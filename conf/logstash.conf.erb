# See http://logstash.net/docs/latest/ for documentation on how to configure Logstash.

input {

    file {
        path => "<%= ENV['OPENSHIFT_LOG_DIR'] %>*.log"
        tags => ["<%= ENV['OPENSHIFT_APP_NAME'] %>", "<%= ENV['OPENSHIFT_GEAR_NAME'] %>", "<%= ENV['OPENSHIFT_NAMESPACE'] %>"]
    }

    sqs {
        access_key_id => "<%= ENV['OPENSHIFT_LOGSTASH_AWS_ACCESSKEY'] %>"
        add_field => {}
        codec => "plain"
        queue => "logstash-sky-stack"
        secret_access_key => "<%= ENV['OPENSHIFT_LOGSTASH_AWS_SECRETKEY'] %>"
        tags => ["sqs"]
        threads => 1
    }
}

output {

    elasticsearch {
        codec => "plain"
        host => "<%= ENV['OPENSHIFT_LOGSTASH_ES_HOST'] %>"
        idle_flush_time => 1
        protocol => "http"
        workers => 1
      }
}
